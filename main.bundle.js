(()=>{"use strict";var t={2935:(t,e,r)=>{var n=r(144),a=r(7968),i=r.n(a);n.Z.use(i());const s=new(i().Store)({strict:!0,state:{theme:window.localStorage.getItem("theme")||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")||"light"},mutations:{updateTheme:function(t,e){t.theme=e,window.localStorage.setItem("theme",e)}},actions:{toggleTheme:function(t){this.commit("updateTheme","dark"!==t.state.theme?"dark":"light")}}});var o=r(8345);function u(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function l(t,e,r,n,a,i,s){try{var o=t[i](s),u=o.value}catch(t){return void r(t)}o.done?e(u):Promise.resolve(u).then(n,a)}function p(t){return function(){var e=this,r=arguments;return new Promise((function(n,a){var i=t.apply(e,r);function s(t){l(i,n,a,s,o,"next",t)}function o(t){l(i,n,a,s,o,"throw",t)}s(void 0)}))}}function f(){return(f=p(regeneratorRuntime.mark((function t(e){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return",[]);case 2:if(r=u(new Set(u(e.matchAll(/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]*\.[a-zA-Z0-9]*\b([-a-zA-Z0-9@:%_+.~#/]*)/g)).map((function(t){return t[0]}))))){t.next=5;break}return t.abrupt("return",{});case 5:return t.next=7,Promise.all(r.map(function(){var t=p(regeneratorRuntime.mark((function t(e){var r,n,a,i,s,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!/imgur\.com\/a\//.test(e)){t.next=14;break}return r=e.split("/").pop(),t.next=4,fetch("https://api.imgur.com/3/album/".concat(r,"/images"),{headers:{Authorization:"Client-ID 18506a441ae08ca"}});case 4:if((n=t.sent).ok){t.next=8;break}return console.warn("Invalid Imgur album! Cannot resolve ".concat(e)),t.abrupt("return",[]);case 8:return t.next=10,n.json();case 10:return a=t.sent,t.abrupt("return",a.data.map((function(t){return t.link})));case 14:if(!/imgur\.com\/gallery\//.test(e)){t.next=28;break}return i=e.split("/").pop(),t.next=18,fetch("https://api.imgur.com/3/gallery/".concat(i),{headers:{Authorization:"Client-ID 18506a441ae08ca"}});case 18:if((s=t.sent).ok){t.next=22;break}return console.warn("Invalid Imgur gallery! Cannot resolve ".concat(e)),t.abrupt("return",[]);case 22:return t.next=24,s.json();case 24:return o=t.sent,t.abrupt("return",o.data.images.map((function(t){return t.link})));case 28:/imgur\.com\/[A-Za-z0-9]*$/.test(e)&&(e="https://i.imgur.com/".concat(e.split("/").pop(),".jpg"));case 29:return t.abrupt("return",e);case 30:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 7:return r=(r=t.sent).flat().filter((function(t){return/\.(png|jpg|jpeg|gif|webp)\/?$/.test(t)})),t.abrupt("return",r);case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}const h={getPictures:function(t){return f.apply(this,arguments)}};const m={props:["type"]};var d=r(1900);const v=(0,d.Z)(m,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("button",{staticClass:"btn",attrs:{type:t.type},on:{click:function(e){return t.$emit("click")}}},[t._t("default")],2)}),[],!1,null,"afc85dd0",null).exports;const g={props:["name","type","placeholder","value","ariaLabel"]};const b=(0,d.Z)(g,(function(){var t=this,e=t.$createElement;return(t._self._c||e)("input",{staticClass:"textfield",attrs:{name:t.name,type:t.type,placeholder:t.placeholder,"aria-label":t.ariaLabel},domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)}}})}),[],!1,null,"7743490d",null).exports,w={components:{Btn:v,Textfield:b},data:function(){return{editing:!1}},computed:{region:function(){var t;return null===(t=this.$route.query.region)||void 0===t?void 0:t.toUpperCase()},regions:function(){var t;return null===(t=this.$route.query.region)||void 0===t?void 0:t.toUpperCase().split("-").filter((function(t){return t&&""!==t}))},global:function(){return!this.regions||0===this.regions.length}},methods:{edit:function(){this.editing=!0,this.$nextTick((function(){return document.getElementById("textfield").focus()}))},unedit:function(){var t=this;setTimeout((function(){return t.editing=!1}),1)}}};const y=(0,d.Z)(w,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"region-picker"},[r("btn",{directives:[{name:"show",rawName:"v-show",value:!t.editing,expression:"!editing"}],class:{square:t.global},attrs:{type:"button"},on:{click:t.edit}},[t._l(t.regions,(function(e,n){return[r("span",[t._v(t._s(e))]),t._v(" "),n+1<t.regions.length?r("span",[t._v(" ¬ ")]):t._e()]})),t._v(" "),t.global?r("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24px",height:"24px"}},[r("path",{attrs:{d:"M0 0h24v24H0z",fill:"none"}}),t._v(" "),r("path",{attrs:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"}})]):t._e()],2),t._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:t.editing,expression:"editing"}],staticClass:"form"},[r("textfield",{attrs:{id:"textfield",name:"region",placeholder:"US-NJ",value:t.region},nativeOn:{blur:function(e){return t.unedit(e)}}}),t._v(" "),r("btn",[t._v("->")])],1)],1)}),[],!1,null,"749576ac",null).exports;const _={components:{Btn:v,Textfield:b},data:function(){return{editing:!1}}};const x=(0,d.Z)(_,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"search"},[r("textfield",{attrs:{name:"q",type:"text",placeholder:"Search","aria-label":"Search",value:t.$route.query.q},nativeOn:{focus:function(e){t.editing=!0},blur:function(e){t.editing=!1}}}),t._v(" "),r("btn",{directives:[{name:"show",rawName:"v-show",value:t.editing,expression:"editing"}]},[t._v("->")])],1)}),[],!1,null,"51a482aa",null).exports;const k={props:{to:String,tabs:Array[String]}};const C=(0,d.Z)(k,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("nav",{staticClass:"tabs"},t._l(t.tabs,(function(e){return r("router-link",{key:e,staticClass:"tab",attrs:{to:{name:t.to,params:{flair:e.toLowerCase()},query:t.$route.query},selected:t.$route.params.flair===e.toLowerCase()}},[t._v("\n        "+t._s(e)+"\n    ")])})),1)}),[],!1,null,"f4a5d798",null).exports;const $={components:{Btn:v}};const j=(0,d.Z)($,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("btn",{staticClass:"theme-picker",on:{click:function(e){return t.$store.dispatch("toggleTheme")}}},[r("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",height:"24",width:"24",viewBox:"0 0 6.3499998 6.35"}},[r("g",{attrs:{transform:"translate(0,-290.64998)"}},[r("path",{attrs:{d:"m 4.3466476,291.17915 a 2.8163548,2.8163548 0 0 1 0.3476437,1.34877 2.8163548,2.8163548 0 0 1 -2.8163547,2.81635 2.8163548,2.8163548 0 0 1 -1.34216911,-0.34104 2.8163548,2.8163548 0 0 0 2.46871101,1.46758 2.8163548,2.8163548 0 0 0 2.8163548,-2.81635 2.8163548,2.8163548 0 0 0 -1.4741857,-2.47531 z"}})])])])}),[],!1,null,"309d6ffe",null).exports,P={components:{ThemePicker:j}};const S=(0,d.Z)(P,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"titlebar"},[r("div",{staticClass:"slot"},[t._t("default")],2),t._v(" "),r("theme-picker")],1)}),[],!1,null,"5100a00d",null).exports;function Z(t,e,r,n,a,i,s){try{var o=t[i](s),u=o.value}catch(t){return void r(t)}o.done?e(u):Promise.resolve(u).then(n,a)}function T(t){return function(){var e=this,r=arguments;return new Promise((function(n,a){var i=t.apply(e,r);function s(t){Z(i,n,a,s,o,"next",t)}function o(t){Z(i,n,a,s,o,"throw",t)}s(void 0)}))}}var q;const A={props:{flair:String},components:{Btn:v,RegionPicker:y,Search:x,Tabs:C,TitleBar:S,ThemePicker:j},data:function(){return{loading:!0,posts:[]}},computed:{query:function(){return this.$route.query.q},region:function(){return this.$route.query.region?"[".concat(this.$route.query.region.toUpperCase()):""}},watch:{flair:function(t){this.loadPosts.bind(this)({flair:t,title:this.region,content:this.query})}},created:function(){this.loadPosts.bind(this)({flair:this.flair,title:this.region,content:this.query})},methods:{loadPosts:(q=T(regeneratorRuntime.mark((function t(e){var r,n,a,i,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loading=!0,r=Object.entries(e).filter((function(t){return t[1]&&"content"!==t[0]})).map((function(t){return t.join(":")})).join(" "),n=["https://www.reddit.com/r/mechmarket/search/.json?q=",r||"",e.content?" "+e.content:"","&restrict_sr=on&sort=new"].join(""),t.next=5,fetch(n);case 5:return a=t.sent,t.next=8,a.json();case 8:return i=t.sent,s=i.data.children,t.next=12,Promise.all(s.map(function(){var t=T(regeneratorRuntime.mark((function t(r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=/\[\w+(-\w+)?]/.exec(r.data.title)[0].slice(1,-1).split("-"),t.t1=r.data.title.split("[H]")[1].split("[W]")["buying"===e.flair?1:0].trim(),"buying"===e.flair){t.next=8;break}return t.next=5,h.getPictures(r.data.selftext);case 5:t.t2=t.sent,t.next=9;break;case 8:t.t2=[];case 9:return t.t3=t.t2,t.t4=r.data.url,t.abrupt("return",{regions:t.t0,title:t.t1,pictures:t.t3,href:t.t4});case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 12:this.posts=t.sent,this.loading=!1;case 14:case"end":return t.stop()}}),t,this)}))),function(t){return q.apply(this,arguments)})}};const I=(0,d.Z)(A,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"gallery surface"},[r("title-bar",[r("form",[r("search"),t._v(" "),r("region-picker")],1)]),t._v(" "),r("tabs",{attrs:{to:"gallery",tabs:["Selling","Buying","Trading"]}}),t._v(" "),r("main",{staticClass:"surface"},[r("div",{directives:[{name:"show",rawName:"v-show",value:t.loading,expression:"loading"}],staticClass:"loading"},[r("div",{staticClass:"surface"},[t._v("> loading...")])]),t._v(" "),t._l(t.posts,(function(e){return r("a",{staticClass:"post",attrs:{href:e.href}},[r("div",{staticClass:"overline"},[r("h2",[t._l(e.regions,(function(n,a){return[r("span",[t._v(t._s(n))]),t._v(" "),a+1<e.regions.length?r("span",{staticClass:"sub"},[t._v(" ¬ ")]):t._e()]}))],2),t._v(" "),r("hr")]),t._v(" "),r("h1",{domProps:{innerHTML:t._s(e.title)}}),t._v(" "),r("div",{staticClass:"gallery"},t._l(e.pictures.slice(0,4),(function(t){return r("div",{staticClass:"img",style:{"background-image":"url("+t}})})),0),t._v(" "),e.pictures.length>4?r("p",{staticClass:"gallery-hint"},[t._v("\n                + "+t._s(e.pictures.length-4)+" more image"+t._s(5!==e.pictures.length?"s":"")+"\n            ")]):t._e()])}))],2)],1)}),[],!1,null,"63543636",null).exports;n.Z.use(o.Z);const z=new o.Z({mode:"history",base:"/Mechmarket/",fallback:!1,routes:[{path:"/",redirect:"/selling"},{path:"/:flair",name:"gallery",component:I,props:!0},{path:"/:flair/:post",name:"post"}]});const E={computed:{theme:function(){return this.$store.state.theme}}};const B=(0,d.Z)(E,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"surface",class:t.theme,attrs:{id:"app"}},[r("router-view")],1)}),[],!1,null,null,null).exports;new n.Z({el:"#app",store:s,router:z,render:function(t){return t(B)}})}},e={};function r(n){if(e[n])return e[n].exports;var a=e[n]={exports:{}};return t[n](a,a.exports,r),a.exports}r.m=t,r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={179:0},e=[[6981,964],[2935,964]],n=()=>{};function a(){for(var n,a=0;a<e.length;a++){for(var i=e[a],s=!0,o=1;o<i.length;o++){var u=i[o];0!==t[u]&&(s=!1)}s&&(e.splice(a--,1),n=r(r.s=i[0]))}return 0===e.length&&(r.x(),r.x=()=>{}),n}r.x=()=>{r.x=()=>{},s=s.slice();for(var t=0;t<s.length;t++)i(s[t]);return(n=a)()};var i=a=>{for(var i,s,[u,c,l,p]=a,f=0,h=[];f<u.length;f++)s=u[f],r.o(t,s)&&t[s]&&h.push(t[s][0]),t[s]=0;for(i in c)r.o(c,i)&&(r.m[i]=c[i]);for(l&&l(r),o(a);h.length;)h.shift()();return p&&e.push.apply(e,p),n()},s=self.webpackChunkmechmarket=self.webpackChunkmechmarket||[],o=s.push.bind(s);s.push=i})(),r.x()})();
//# sourceMappingURL=main.bundle.js.map